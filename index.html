<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Guest Booking → Generate Invoice</title>
  <style>
    :root { 
      --bg:#0a0e1a; 
      --card:#1a1f35; 
      --muted:#94a3b8; 
      --text:#f1f5f9; 
      --accent:#f59e0b;
      --accent-hover:#d97706;
      --secondary:#8b5cf6;
      --border:#334155; 
      --shadow:0 20px 50px rgba(0,0,0,.5);
      --gold:#d4af37;
      --crimson:#b91c1c;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      margin:0;
      font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
      background: linear-gradient(135deg, #1e293b 0%, #0f172a 50%, #1e1b4b 100%);
      color:var(--text);
      min-height:100vh;
    }

    /* Brand Banner */
    .brandbar{
      position: sticky; 
      top: 0; 
      z-index: 50;
      background: linear-gradient(135deg, #991b1b 0%, #b91c1c 25%, #dc2626 50%, #b91c1c 75%, #991b1b 100%);
      color:#fff; 
      box-shadow: 0 8px 32px rgba(185, 28, 28, 0.4);
      border-bottom: 2px solid rgba(212, 175, 55, 0.3);
    }
    .brandwrap{
      max-width:1200px;
      margin:0 auto;
      padding:16px 24px;
      display:flex;
      align-items:center;
      gap:16px;
    }
    .brandlogo{
      width:60px;
      height:60px;
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      border:2px solid var(--gold);
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(255, 255, 255, 0.1));
      font-weight:900; 
      font-size:20px;
      letter-spacing:1px;
      color:var(--gold);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .brandtxt{line-height:1.3}
    .brandtxt .name{
      font-weight:800;
      font-size:22px;
      letter-spacing:0.5px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    .brandtxt .sub{
      font-size:13px;
      opacity:.9;
      color:rgba(255,255,255,0.85);
    }

    header{
      max-width:1100px;
      margin:32px auto 16px;
      padding:0 24px;
    }
    header h1{
      margin:0 0 8px;
      font-size:36px;
      background: linear-gradient(135deg, #f59e0b, #d97706);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    header p{
      margin:0;
      color:var(--muted);
      font-size:15px;
    }

    .container{
      max-width:1100px;
      margin:24px auto 80px;
      padding:0 24px;
      display:grid;
      gap:24px;
    }
    .card{
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.05), rgba(245, 158, 11, 0.03));
      border:2px solid var(--border);
      border-radius:20px;
      box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
    }
    .card .body{padding:32px}
    .card h2{
      margin:24px 0 16px;
      font-size:22px;
      color:var(--accent);
      border-bottom:2px solid var(--border);
      padding-bottom:8px;
    }
    .card h2:first-child{margin-top:0}
    
    .row{display:grid;gap:16px}
    @media (min-width:640px){.row.two{grid-template-columns:1fr 1fr}}
    
    label{
      display:block;
      font-size:14px;
      font-weight:600;
      color:var(--muted);
      margin:0 0 8px;
    }
    input,textarea,select{
      width:100%;
      padding:14px 16px;
      border-radius:12px;
      border:2px solid var(--border);
      background:rgba(15, 23, 42, 0.8);
      color:var(--text);
      outline:none;
      transition: all 0.3s ease;
      font-size:15px;
    }
    input:focus,textarea:focus,select:focus{
      border-color:var(--accent);
      box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
    }
    textarea{resize:vertical;min-height:70px}
    
    .actions{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top:24px;
    }
    button{
      border:0;
      padding:14px 24px;
      border-radius:12px;
      cursor:pointer;
      font-weight:700;
      font-size:15px;
      background: linear-gradient(135deg, var(--accent), var(--accent-hover));
      color:#fff;
      box-shadow:0 4px 12px rgba(245, 158, 11, 0.3);
      transition: all 0.3s ease;
    }
    button:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(245, 158, 11, 0.4);
    }
    button.secondary{
      background: linear-gradient(135deg, var(--secondary), #7c3aed);
      box-shadow:0 4px 12px rgba(139, 92, 246, 0.3);
    }
    button.secondary:hover{
      box-shadow:0 6px 20px rgba(139, 92, 246, 0.4);
    }
    button:disabled{
      opacity:.6;
      cursor:not-allowed;
      transform:none;
    }

    /* Rooms row - expanded grid */
    .room-row{
      display:grid;
      gap:12px;
      align-items:end;
      margin-bottom:16px;
      padding:20px;
      background:rgba(139, 92, 246, 0.05);
      border:1px solid var(--border);
      border-radius:12px;
      grid-template-columns: repeat(3, 1fr);
    }
    .room-row .field{
      display:flex;
      flex-direction:column;
    }
    .room-row .remove-wrap{
      grid-column: 1 / -1;
      display:flex;
      justify-content:flex-end;
      margin-top:8px;
    }
    .room-row .remove{
      background:linear-gradient(135deg, #dc2626, #b91c1c);
      border:0;
      color:#fff;
      padding:12px 20px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      box-shadow:0 4px 12px rgba(220, 38, 38, 0.3);
      transition: all 0.3s ease;
    }
    .room-row .remove:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(220, 38, 38, 0.4);
    }
    .room-toolbar{
      display:flex;
      gap:12px;
      margin:8px 0 16px;
    }
    @media (max-width:900px){ 
      .room-row{grid-template-columns:1fr 1fr;} 
    }
    @media (max-width:600px){ 
      .room-row{grid-template-columns:1fr;} 
    }

    /* Date preview */
    .date-wrap{
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }
    .pretty-date{
      min-width:180px;
      padding:12px 16px;
      border:2px dashed var(--border);
      border-radius:10px;
      color:var(--accent);
      font-weight:600;
      background:rgba(245, 158, 11, 0.05);
    }

    @media print{
      body{background:#fff}
      .brandbar{background:#fff;color:#000;border-bottom:1px solid #ddd;box-shadow:none}
      .brandlogo{border-color:#d4af37;background:#fff;color:#000}
    }
  </style>
</head>
<body>
  <div class="brandbar" role="banner" aria-label='Company banner: "Deyaar Makkah Bangladesh"'>
    <div class="brandwrap">
      <div class="brandlogo">DMB</div>
      <div class="brandtxt">
        <div class="name">DEYAAR MAKKAH BANGLADESH</div>
        <div class="sub">Premium Hotel Booking Services</div>
      </div>
    </div>
  </div>

  <header>
    <h1>Guest Booking Form</h1>
    <p>Enter guest details, add rooms with meal options, and generate a professional invoice instantly.</p>
  </header>

  <div class="container">
    <section class="card form">
      <div class="body">
        <h2>Hotel & Guest Information</h2>
        <div class="row two">
          <div>
            <label for="hotelName">Hotel Name *</label>
            <input id="hotelName" type="text" placeholder="e.g., Aurora Grand Hotel" required>
          </div>
          <div>
            <label for="hotelAddress">Hotel Address *</label>
            <textarea id="hotelAddress" rows="2" placeholder="Street, City, Country" required></textarea>
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="guestName">Guest Name *</label>
            <input id="guestName" type="text" placeholder="e.g., Ahmed Rahman" required>
          </div>
          <div>
            <label for="guestAddress">Guest Address *</label>
            <textarea id="guestAddress" rows="2" placeholder="Street, City, Postal Code" required></textarea>
          </div>
        </div>

        <h2>Room Details</h2>
        <div id="roomsContainer">
          <div class="room-row">
            <div class="field">
              <label>Number of Rooms *</label>
              <input class="roomQty" type="number" min="1" step="1" value="1" required>
            </div>
            <div class="field">
              <label>Room View *</label>
              <select class="roomView" required>
                <option value="Non view">Non view</option>
                <option value="City view">City view</option>
                <option value="Haram view">Haram view</option>
              </select>
            </div>
            <div class="field">
              <label>Room Type *</label>
              <select class="roomType" required>
                <option value="Single Bed">Single Bed</option>
                <option value="Double Bed">Double Bed</option>
                <option value="Suite">Suite</option>
                <option value="Triple">Triple</option>
                <option value="Quad">Quad</option>
                <option value="Quint">Quint</option>
                <option value="Hexa">Hexa</option>
              </select>
            </div>
            <div class="field">
              <label>Room Rate (Tk) *</label>
              <input class="rate" type="number" min="0" step="1" placeholder="1500" required>
            </div>
            <div class="field">
              <label>Meal Type</label>
              <select class="mealType">
                <option value="None">None</option>
                <option value="Breakfast">Breakfast</option>
                <option value="Half Board">Half Board (Breakfast + Dinner)</option>
                <option value="Full Board">Full Board (All Meals)</option>
              </select>
            </div>
            <div class="field">
              <label>Meal Rate (Tk)</label>
              <input class="mealRate" type="number" min="0" step="1" placeholder="0" value="0">
            </div>
            <div class="remove-wrap">
              <button type="button" class="remove" aria-label="Remove room">Remove Room</button>
            </div>
          </div>
        </div>
        <div class="room-toolbar">
          <button id="addRoomBtn" type="button">+ Add Another Room</button>
        </div>

        <h2>Stay Duration</h2>
        <div class="row two">
          <div>
            <label for="checkIn">Check-in Date *</label>
            <div class="date-wrap">
              <input id="checkIn" type="date" required>
              <div id="prettyIn" class="pretty-date">—</div>
            </div>
          </div>
          <div>
            <label for="checkOut">Check-out Date *</label>
            <div class="date-wrap">
              <input id="checkOut" type="date" required>
              <div id="prettyOut" class="pretty-date">—</div>
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="btnSubmit" type="button">Generate Invoice</button>
          <button id="btnReset" class="secondary" type="button">Reset Form</button>
        </div>
      </div>
    </section>
  </div>

  <script>
    const $ = s => document.querySelector(s);
    const roomsContainer = $('#roomsContainer');

    function bindRemove(btn){
      btn.addEventListener('click', () => {
        const rows = roomsContainer.querySelectorAll('.room-row');
        if (rows.length <= 1) { alert('At least one room is required.'); return; }
        btn.closest('.room-row').remove();
      });
    }
    bindRemove(roomsContainer.querySelector('.room-row .remove'));

    function makeRoomRow(init={}){
      const row = document.createElement('div');
      row.className = 'room-row';
      row.innerHTML = `
        <div class="field">
          <label>Number of Rooms *</label>
          <input class="roomQty" type="number" min="1" step="1" value="1" required>
        </div>
        <div class="field">
          <label>Room View *</label>
          <select class="roomView" required>
            <option value="Non view">Non view</option>
            <option value="City view">City view</option>
            <option value="Haram view">Haram view</option>
          </select>
        </div>
        <div class="field">
          <label>Room Type *</label>
          <select class="roomType" required>
            <option value="Single Bed">Single Bed</option>
            <option value="Double Bed">Double Bed</option>
            <option value="Suite">Suite</option>
            <option value="Triple">Triple</option>
            <option value="Quad">Quad</option>
            <option value="Quint">Quint</option>
            <option value="Hexa">Hexa</option>
          </select>
        </div>
        <div class="field">
          <label>Room Rate (Tk) *</label>
          <input class="rate" type="number" min="0" step="1" placeholder="1500" required>
        </div>
        <div class="field">
          <label>Meal Type</label>
          <select class="mealType">
            <option value="None">None</option>
            <option value="Breakfast">Breakfast</option>
            <option value="Half Board">Half Board (Breakfast + Dinner)</option>
            <option value="Full Board">Full Board (All Meals)</option>
          </select>
        </div>
        <div class="field">
          <label>Meal Rate (Tk)</label>
          <input class="mealRate" type="number" min="0" step="1" placeholder="0" value="0">
        </div>
        <div class="remove-wrap">
          <button type="button" class="remove" aria-label="Remove room">Remove Room</button>
        </div>
      `;
      if (init.qty != null) row.querySelector('.roomQty').value = init.qty;
      if (init.roomView) row.querySelector('.roomView').value = init.roomView;
      if (init.roomType) row.querySelector('.roomType').value = init.roomType;
      if (init.rate != null) row.querySelector('.rate').value = init.rate;
      if (init.mealType) row.querySelector('.mealType').value = init.mealType;
      if (init.mealRate != null) row.querySelector('.mealRate').value = init.mealRate;
      bindRemove(row.querySelector('.remove'));
      return row;
    }

    $('#addRoomBtn').addEventListener('click', () => {
      roomsContainer.appendChild(makeRoomRow());
    });

    function fmtPretty(d){
      if(!d) return '—';
      const dt = new Date(d + 'T00:00:00');
      if(Number.isNaN(+dt)) return '—';
      return dt.toLocaleDateString(undefined,{year:'numeric', month:'long', day:'2-digit'});
    }
    function syncPretty(){
      $('#prettyIn').textContent  = fmtPretty($('#checkIn').value);
      $('#prettyOut').textContent = fmtPretty($('#checkOut').value);
    }
    $('#checkIn').addEventListener('change', syncPretty);
    $('#checkOut').addEventListener('change', syncPretty);

    (function initDates(){
      const today = new Date();
      const tomorrow = new Date(today.getTime()+86400000);
      const pad = n => String(n).padStart(2,'0');
      const ymd = d => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
      $('#checkIn').value = ymd(today);
      $('#checkOut').value = ymd(tomorrow);
      syncPretty();
    })();

    function submitAndRedirect(){
      const hotelName = $('#hotelName').value.trim();
      const hotelAddress = $('#hotelAddress').value.trim();
      const guestName = $('#guestName').value.trim();
      const guestAddress = $('#guestAddress').value.trim();
      const checkin = $('#checkIn').value;
      const checkout = $('#checkOut').value;

      const rooms = Array.from(roomsContainer.querySelectorAll('.room-row')).map(row => {
        const qty  = Number(row.querySelector('.roomQty')?.value ?? 0);
        const rate = Number(row.querySelector('.rate')?.value ?? 0);
        const mealRate = Number(row.querySelector('.mealRate')?.value ?? 0);
        const roomView = row.querySelector('.roomView')?.value || '';
        const roomType = row.querySelector('.roomType')?.value || '';
        const mealType = row.querySelector('.mealType')?.value || 'None';
        return { qty, roomView, roomType, rate, mealType, mealRate };
      });

      if(!hotelName || !hotelAddress || !guestName || !guestAddress || !checkin || !checkout){
        alert('Please fill all required fields.');
        return;
      }

      for (const r of rooms){
        if(!Number.isInteger(r.qty) || r.qty < 1 || !isFinite(r.rate) || r.rate < 0 || !r.roomView || !r.roomType){
          alert('Each room needs: quantity ≥ 1, a view, a type, and a non-negative rate.');
          return;
        }
      }

      const params = new URLSearchParams({
        hotelName, hotelAddress, guestName, guestAddress, checkin, checkout,
        rooms: JSON.stringify(rooms)
      });
      window.location.href = `invoice.html?${params.toString()}`;
    }
    $('#btnSubmit').addEventListener('click', submitAndRedirect);

    $('#btnReset').addEventListener('click', ()=>{ 
      document.querySelectorAll('input, textarea, select').forEach(e=>{ 
        if(e.tagName==='SELECT') e.selectedIndex = 0; else e.value=''; 
      });
      roomsContainer.innerHTML = '';
      roomsContainer.appendChild(makeRoomRow());
      const today = new Date(), tomorrow = new Date(today.getTime()+86400000);
      const pad = n => String(n).padStart(2,'0');
      const ymd = d => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
      $('#checkIn').value = ymd(today);
      $('#checkOut').value = ymd(tomorrow);
      syncPretty();
    });
  </script>
</body>
</html>